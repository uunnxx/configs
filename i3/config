set $mod Mod4
set $ctrl Control
set $alt Mod1
set $mod3 Mod3
set $sh Shift
set $term "alacritty"
set $term_float "alacritty --class float"
set $ranger "alacritty --class ranger -e ranger"
set $trans_ru "alacritty --class translator -e trans -t ru -I"
set $trans_en "alacritty --class translator -e trans -t en -I"
# set $trans "urxvt -name translator -e trans -t ru -I"
set $fm "nautilus"
set $menu "rofi -show drun"
set $menu2 "rofi -show run"
set $dmenu "dmenu_run"
set $barcmd i3status
set $calc "qalculate-gtk"

font pango:Iosevka Nerd Font Bold 10

floating_modifier $mod

# Hide borders
hide_edge_borders smart
# hide_edge_borders both
# hide_edge_borders horizontal

# `new_window pixel 4` will be deprecated soon
# use `default_border`, and  `default_floating_border` instead
default_border pixel 4
default_floating_border pixel 4
bindsym $mod+u border none
bindsym $mod+y border pixel 4
bindsym $mod+$sh+u border normal 4

# focus next/previous visible window
# bindsym $mod+n exec --no-startup-id ~/.config/i3/scripts/focus_next_visible.py
# bindsym $mod+$sh+n exec --no-startup-id ~/.config/i3/scripts/focus_next_visible.py reverse

bindsym $mod+Return exec $term
bindsym $mod+$sh+Return exec $term_float

# Kill
# bindsym $mod+$sh+a kill
bindsym $mod+$sh+c kill

# get mouse keys: `xev | grep button`
# button 1 left primary
# button 2 middle
# button 3 right
# button 4 scroll up
# button 5 scroll down
# button 6 scroll left
# button 7 scroll right
# button 8 left side 1st button
# button 9 left side 2nd button

bindsym --whole-window $alt+button1 move scratchpad
bindsym --whole-window $alt+button2 move position center
bindsym --whole-window $alt+button3 kill
# temp. comment `scroll up & down` because of `--whole-window`
# get's focused when scrolling
# bindsym --whole-window $alt+button4 resize grow width 25 px or 25 ppt
# bindsym --whole-window $alt+button5 resize grow height 25 px or 25 ppt
bindsym --whole-window $alt+button8 fullscreen toggle
bindsym --whole-window $alt+button9 floating toggle

# bindsym --whole-window $alt+button4 focus left
# bindsym --whole-window $alt+button5 focus down

bindsym $mod+d exec --no-startup-id $menu
bindsym $mod+$sh+d exec --no-startup-id $menu2

bindsym $mod+n exec --no-startup-id rofi_books

bindsym $mod+g exec --no-startup-id $HOME/.config/i3/scripts/wmfocus.sh
# bindsym $mod+$sh+g exec --no-startup-id

bindsym $ctrl+Print exec "flameshot gui"


# change and move focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right
bindsym $mod+$sh+h move left
bindsym $mod+$sh+j move down
bindsym $mod+$sh+k move up
bindsym $mod+$sh+l move right

# workspace back and forth (with/without active container)
workspace_auto_back_and_forth yes
bindsym $mod+b workspace back_and_forth
bindsym $mod+$sh+b move container to workspace back_and_forth; workspace back_and_forth

# split orientation
bindsym $alt+s split toggle

# toggle fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle
bindsym $mod+$sh+f fullscreen toggle global

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle all

# toggle tiling / floating
bindsym $mod+$sh+space floating toggle
bindsym $mod+space focus mode_toggle
bindsym $mod+$sh+s sticky toggle

# focus the parent container
bindsym $mod+$sh+w focus parent

# move the currently focused window to the scratchpad
bindsym $mod+$sh+minus move scratchpad
bindsym $mod+minus scratchpad show


bindsym $alt+space exec --no-startup-id "rofi -show window"
bindsym $alt+$sh+space exec --no-startup-id "rofi -show windowcd"

bindsym $mod+c move position center

bindsym $mod+m bar mode toggle

#navigate workspaces next / previous
bindsym $alt+$sh+l workspace next
bindsym $alt+$sh+h workspace prev

# Workspaces
set $left DVI-D-0
set $right HDMI-A-0

# bindsym $alt+$sh+Right focus output $left; workspace next; focus output $right; workspace next

# switch between outputs
bindsym $alt+l focus output right
bindsym $alt+h focus output left

set $right0 "0000 零"
set $right1 "0001 一"
set $right2 "0010 二"
set $right3 "0011 三"
set $right4 "0100 四"
set $right5 "0101 五"
set $right6 "0110 六"
set $right7 "0111 七"
set $right8 "1000 八"
set $right9 "1001 九"

set $left0 "零 0000"
set $left1 "一 0001"
set $left2 "二 0010"
set $left3 "三 0011"
set $left4 "四 0100"
set $left5 "五 0101"
set $left6 "六 0110"
set $left7 "七 0111"
set $left8 "八 1000"
set $left9 "九 1001"

# more workspaces
set $leftA "RUBY"
set $leftB "PYTHON"
set $leftC "ELIXIR"
set $leftD "LINUX"
set $leftE "SCIENCE"
set $leftF "LINGUISTICS"
set $leftG "SECURITY"
set $leftH "WEB"
set $leftI "CS"
set $leftJ "RE"
set $leftK "BOOKS"

workspace $right0 output $right
workspace $right1 output $right
workspace $right2 output $right
workspace $right3 output $right
workspace $right4 output $right
workspace $right5 output $right
workspace $right6 output $right
workspace $right7 output $right
workspace $right8 output $right
workspace $right9 output $right

workspace $left0 output $left
workspace $left1 output $left
workspace $left2 output $left
workspace $left3 output $left
workspace $left4 output $left
workspace $left5 output $left
workspace $left6 output $left
workspace $left7 output $left
workspace $left8 output $left
workspace $left9 output $left
workspace $leftA output $left
workspace $leftB output $left
workspace $leftC output $left
workspace $leftD output $left
workspace $leftE output $left
workspace $leftF output $left
workspace $leftG output $left
workspace $leftH output $left
workspace $leftI output $left
workspace $leftJ output $left
workspace $leftK output $left

bindsym $mod+0 workspace $right0
bindsym $mod+1 workspace $right1
bindsym $mod+2 workspace $right2
bindsym $mod+3 workspace $right3
bindsym $mod+4 workspace $right4
bindsym $mod+5 workspace $right5
bindsym $mod+6 workspace $right6
bindsym $mod+7 workspace $right7
bindsym $mod+8 workspace $right8
bindsym $mod+9 workspace $right9

bindsym $alt+0 workspace $left0
bindsym $alt+1 workspace $left1
bindsym $alt+2 workspace $left2
bindsym $alt+3 workspace $left3
bindsym $alt+4 workspace $left4
bindsym $alt+5 workspace $left5
bindsym $alt+6 workspace $left6
bindsym $alt+7 workspace $left7
bindsym $alt+8 workspace $left8
bindsym $alt+9 workspace $left9

# bindsym $mod+$sh+0 move container to workspace $ws0; workspace $ws0
bindsym $mod+$sh+0 move container to workspace $right0
bindsym $mod+$sh+1 move container to workspace $right1
bindsym $mod+$sh+2 move container to workspace $right2
bindsym $mod+$sh+3 move container to workspace $right3
bindsym $mod+$sh+4 move container to workspace $right4
bindsym $mod+$sh+5 move container to workspace $right5
bindsym $mod+$sh+6 move container to workspace $right6
bindsym $mod+$sh+7 move container to workspace $right7
bindsym $mod+$sh+8 move container to workspace $right8
bindsym $mod+$sh+9 move container to workspace $right9

bindsym $alt+$sh+0 move container to workspace $left0
bindsym $alt+$sh+1 move container to workspace $left1
bindsym $alt+$sh+2 move container to workspace $left2
bindsym $alt+$sh+3 move container to workspace $left3
bindsym $alt+$sh+4 move container to workspace $left4
bindsym $alt+$sh+5 move container to workspace $left5
bindsym $alt+$sh+6 move container to workspace $left6
bindsym $alt+$sh+7 move container to workspace $left7
bindsym $alt+$sh+8 move container to workspace $left8
bindsym $alt+$sh+9 move container to workspace $left9


for_window [all] title_window_icon on
for_window [all] border pixel 4

title_align center
# title_format: %class, %instance, %title
for_window [all] title_format " %title "

for_window [title="File Transfer*"] floating enable
for_window [class="GParted"] floating enable border normal 4
for_window [class="Lightdm-settings"] floating enable
for_window [class="Lxappearance"] floating enable sticky enable border normal
for_window [class="Pavucontrol"] floating enable

for_window [class="URxvt" instance="translator"] floating enable resize set 880 400
for_window [class="URxvt" instance="translator"] move position 1040 658

for_window [class="Alacritty" instance="translator"] floating enable resize set 880 400
for_window [class="Alacritty" instance="translator"] move position 1040 658

for_window [class="Alacritty" instance="ranger"] floating enable resize set 1240 690
for_window [class="Alacritty" instance="ranger"] move position center
for_window [class="Alacritty" instance="float"] floating enable resize set 900 450
for_window [class="Alacritty" instance="float"] move position center

for_window [class="Qalculate-gtk"] floating enable resize set 900 450
for_window [class="Qalculate-gtk"] move position center

for_window [class="Picture-in-picture"] floating enable border none
for_window [class="mpv"] floating enable resize set 1240 690
for_window [class="mpv"] move position center
for_window [class="mpv"] border normal 4


for_window [class="Eog"] floating enable resize set 1240 690
for_window [class="Eog"] move position center
for_window [class="Zathura"] floating enable resize set 1340 780
for_window [class="Zathura"] move position center
# for_window [class="Zathura"] border normal 4

for_window [class="Org.gnome.Nautilus"] border normal 4
# for_window [class="Org.gnome.Nautilus"] floating enable resize set 1340 780
# for_window [class="Org.gnome.Nautilus"] move position center

for_window [class="File-roller"] floating enable resize set 1340 780
for_window [class="File-roller"] move position center
for_window [class="File-roller"] border normal 4
for_window [class="Evince"] floating enable resize set 1340 780
for_window [class="Evince"] move position center
for_window [class="Zeal"] floating enable resize set 1340 780
for_window [class="Zeal"] move position center
# for_window [urgent=latest] focus
for_window [class="komorebi"] border none floating disable


# read 1 character and mark the current window with this character
bindsym $alt+m exec i3-input -F 'mark --toggle %s' -l 1 -P 'MARK: ' -f '-misc-fixed-*-*-*-*-20-*-*-*-*-*-iso10646-*'

# read 1 character and go to the window with the character
bindsym $alt+g exec i3-input -F '[con_mark="%s"] focus' -l 1 -P 'GOTO: ' -f '-misc-fixed-*-*-*-*-20-*-*-*-*-*-iso10646-*'



bindsym Pause exec --no-startup-id systemctl suspend


#
# Colors
#
set $fff #FFFFFF
set $aaa #FF7043
set $ttt #141C21

set $cla #39375B
set $clb #745C97
set $clc #443850
set $cld #2D1E2F
set $cle #9C89B8
set $clf #EBA6A9
set $clg #25044B
set $clh #F0544F
set $cli #462A67
set $clj #5B3758


# Gruvbox
set $gruv0 #1d2021
set $gruv8 #928374
set $gruv1 #CC241D
set $gruv9 #FB4934
set $gruv2 #98971A
set $gruvA #B8BB26
set $gruv3 #D79921
set $gruvB #FABD2F
set $gruv4 #458588
set $gruvC #83A598
set $gruv5 #B16286
set $gruvD #D3869B
set $gruv6 #689D6A
set $gruvE #8EC07C
set $gruv7 #A89984
set $gruvF #EBDBB2


# right monitor
bar {
  font pango:Iosevka Nerd Font Bold 10
  tray_padding 0
  output $right
  tray_output none
  i3bar_command i3bar --transparency
  # i3bar_command i3bar
  status_command i3status --config ~/.config/i3/i3status.conf
  position bottom
  separator_symbol " | "
  colors {
    background $gruv044
    statusline $gruvB
    separator  $clh
    #                  border     backgr.    text
    focused_workspace  $gruvB     $gruvB     $gruv0
    active_workspace   $clf       $clf       $gruv0
    inactive_workspace $clj       $clj       $fff
    urgent_workspace   $gruv9     $gruv9     $fff
    binding_mode       $gruvB     $gruvB     $gruv0
  }
  workspace_min_width 80
  workspace_buttons yes
  hidden_state hide
  binding_mode_indicator yes
  # mode hide
  modifier none
}


# left monitor
bar {
  font pango:Iosevka Nerd Font Bold 10
  tray_padding 0
  output $left
  tray_output $left
  i3bar_command i3bar --transparency
  # i3bar_command i3bar
  # status_command i3status --config ~/.config/i3/i3status-small.conf
  position bottom
  separator_symbol " | "
  colors {
    background $gruv044
    statusline $gruvB
    separator  $clh
    #                  border     backgr.    text
    focused_workspace  $gruvB     $gruvB     $gruv0
    active_workspace   $clf       $clf       $gruv0
    inactive_workspace $clj       $clj       $fff
    urgent_workspace   $gruv9     $gruv9     $fff
    binding_mode       $gruvB     $gruvB     $gruv0
  }
  workspace_min_width 80
  workspace_buttons yes
  hidden_state hide
  binding_mode_indicator yes
  # mode hide
  modifier none
}

# class                   border    backgr.   text        indic.   child_border
client.focused            $clj      $clj      $fff        $gruv1
client.focused_inactive   $clb      $clb      $fff        $gruv1
client.unfocused          $cla      $cla      $fff        $gruv1
client.urgent             $clh      $clh      $fff        $gruv1

focus_follows_mouse no
focus_wrapping no
# mouse_warping none

# smart, ignore, leave_fullscreen
popup_during_fullscreen smart

# Autostart applications
exec --no-startup-id /usr/bin/fcitx5
exec --no-startup-id /usr/bin/diodon
exec --no-startup-id xclip
exec --no-startup-id flameshot
exec --no-startup-id volumeicon
exec --no-startup-id nm-applet
exec --no-startup-id compton --config ~/.config/compton.conf -b
# exec --no-startup-id unagi

exec_always --no-startup-id xset r rate 150 40
# Set screentimeout to 600 sec
exec_always --no-startup-id xset dpms 600
# Make displays work as expected
exec --no-startup-id xrandr --output DVI-D-0 --auto --left-of HDMI-A-0
# CapsLock is Mod4
exec_always --no-startup-id setxkbmap -option caps:super
exec_always --no-startup-id alttab -w 1 -fg "#fabd2f" -bg "#141c21" -frame "#fabd2f" -t 128x150 -i 127x64

# To reset settings redshift -x
exec_always --no-startup-id redshift -x; exec redshift -O 3500

# Input method settings
# Comment this lines out because we using fcitx right now
# bindsym d exec --no-startup-id "setxkbmap -layout us,ru -variant dvp, -option grp:alt_space_toggle", mode "default"
# bindsym q exec --no-startup-id "setxkbmap -layout us,ru -option grp:alt_space_toggle", mode "default"

# exec_always --no-startup-id back4 0.07 $HOME/Pictures/lv/3.gif


# Not used keys:
# 0..9 num_lock: off

# bindsym KP_End exec $fm
# bindsym KP_Down exec $fm
# bindsym KP_Next exec mpvctl next

bindsym KP_Left move container to output left; focus output left
bindsym $mod+KP_Left move workspace to output left

# bindsym KP_Begin exec

bindsym KP_Right move container to output right; focus output right
bindsym $mod+KP_Right move workspace to output right

# bindsym KP_Home exec $fm
# bindsym KP_Up exec $fm
# bindsym KP_Prior exec mpvctl previous

# Right side:
# bindsym KP_Insert exec $fm
# bindsym KP_Delete exec chromium
# bindsym KP_Enter exec alacritty -e irb
bindsym $mod+KP_Enter exec $fm
bindsym $mod+KP_Add exec $calc

# bindsym KP_Multiply exec $fm
# bindsym --release KP_Divide exec xkill
bindsym --release $mod+KP_Subtract exec xkill


# bindsym $alt+Up exec "pactl set-sink-volume @DEFAULT_SINK@ +1000"; exec dunstify -r 2222 -u low "Volume: $(pactl list sinks | tr ' ' '\n' | grep -m1 '%' | tr -d '%')"
# which current_volume: .local/bin/current_volume
# bindsym $alt+Up exec "pactl set-sink-volume @DEFAULT_SINK@ +1000"; exec dunstify -r 2222 -u low "Volume: $(current_volume)"
# bindsym $alt+Down exec "pactl set-sink-volume @DEFAULT_SINK@ -1000"; exec dunstify -r 2222 -u low "Volume: $(current_volume)"

bindsym $alt+Up exec $HOME/.local/bin/volume_up
bindsym $alt+Down exec $HOME/.local/bin/volume_down

# mpvctl https://gist.github.com/dwgill/a66769e0edef69c04d3b

bindsym $mod+Left exec mpvctl previous; exec dunstify -r 1111 -u low "PREVIOUS TRACK"
bindsym $mod+Right exec mpvctl next; exec dunstify -r 1111 -u low "NEXT TRACK"
bindsym $mod+Up exec dunstify -r 9999 -u normal "NOW PLAYING:" "$(exec mpvctl play)"
bindsym $mod+Down exec mpvctl pause; exec dunstify -r 1111 -u low "PAUSE"

# Next: PageDown, Prior: PageUp
bindsym $ctrl+$alt+Next exec obs-cli --password "bakabakabaka" scene switch right; exec dunstify -u low -r 7979 "OBS SCENE SWITCHED" "Active scene: <b>RIGHT</b>"
bindsym $ctrl+$alt+Prior exec obs-cli --password "bakabakabaka" scene switch left; exec dunstify -u low -r 7979 "OBS SCENE SWITCHED" "Active scene: <b>LEFT</b>"


# MODES


set $run [g]oogle, [f]irefox, [t]rans_en, [T]rans_ru, V[paste]
mode "$run" {
  bindsym g exec --no-startup-id google-chrome, mode "default"
  bindsym f exec --no-startup-id firefox, mode "default"

  bindsym t exec --no-startup-id $trans_en, mode "default"
  bindsym $sh+t exec --no-startup-id $trans_ru, mode "default"

  bindsym $sh+v exec --no-startup-id diodon, mode "default"

  bindsym Return mode "default"
  bindsym Escape mode "default"
}
bindsym $mod+t mode "$run"


set $screenshot [return], [space] focused, [c-space] selected
mode "$screenshot" {
  bindsym --release Return exec --no-startup-id ~/.config/i3/scripts/scrot.sh
  bindsym --release space exec --no-startup-id ~/.config/i3/scripts/scrot_focused.sh
  bindsym --release $ctrl+space exec --no-startup-id ~/.config/i3/scripts/scrot_select.sh
  bindsym Escape mode "default"

}
bindsym Print mode "$screenshot"


set $more_workspaces    a:RUBY   b:PYTHON   c:ELIXIR   d:LINUX   e:SCIENCE   f:LINGUISTICS   g:SECURITY   h:WEB   i:CS   j:RE   k:BOOKS
mode "$more_workspaces" {
  bindsym a workspace $leftA, mode "default"
  bindsym b workspace $leftB, mode "default"
  bindsym c workspace $leftC, mode "default"
  bindsym d workspace $leftD, mode "default"
  bindsym e workspace $leftE, mode "default"
  bindsym f workspace $leftF, mode "default"
  bindsym g workspace $leftG, mode "default"
  bindsym h workspace $leftH, mode "default"
  bindsym i workspace $leftI, mode "default"
  bindsym j workspace $leftJ, mode "default"
  bindsym k workspace $leftK, mode "default"

  bindsym Return mode "default"
  bindsym Escape mode "default"
}
bindsym $mod+p mode "$more_workspaces"


set $mode_system (e)xit, (S-r)eboot, (S-s)hutdown, I3:(r)estart, re(l)oad, (c)aps2mod, (w)allpapers
mode "$mode_system" {
  bindsym e exec --no-startup-id i3-msg exit, mode "default"
  bindsym $sh+r exec --no-startup-id reboot, mode "default"
  bindsym r exec --no-startup-id i3-msg restart, "default"
  bindsym l exec --no-startup-id i3-msg reload, "default"
  bindsym $sh+s exec --no-startup-id shutdown, mode "default"
  bindsym c exec --no-startup-id "setxkbmap -option caps:super", mode "default"
  bindsym w exec --no-startup-id feh --bg-scale --randomize ~/Pictures/wallpapers/*

  bindsym Return mode "default"
  bindsym Escape mode "default"
}
bindsym $mod+Escape mode "$mode_system"


mode "resize" {
  bindsym h resize shrink width 5 px or 5 ppt
  bindsym j resize grow height 5 px or 5 ppt
  bindsym k resize shrink height 5 px or 5 ppt
  bindsym l resize grow width 5 px or 5 ppt

  bindsym Left resize shrink width 50 px or 50 ppt
  bindsym Down resize grow height 50 px or 50 ppt
  bindsym Up resize shrink height 50 px or 50 ppt
  bindsym Right resize grow width 50 px or 50 ppt

  bindsym Return mode "default"
  bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

